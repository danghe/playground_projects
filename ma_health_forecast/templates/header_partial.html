<!-- Shared Executive Header -->
<header class="navbar navbar-expand-lg sticky-top glass-header">
    <div class="container-fluid">
        <!-- Brand -->
        <a class="navbar-brand d-flex align-items-center gap-2" href="/">
            <span class="fw-light text-theme-base">INTRALINKS</span>
            <span class="fw-bold text-theme-accent">DEAL COMMAND</span>
        </a>

        <!-- Mobile Toggle -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navigation -->
        <div class="collapse navbar-collapse visible" id="navbarNav">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-center gap-1">
                <li class="nav-item">
                    <a class="nav-link px-3 rounded-pill {{ 'active' if active_page == 'macro' else '' }}"
                        href="/">Market Health</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link px-3 rounded-pill {{ 'active' if active_page == 'radar' else '' }}"
                        href="/deal-radar">Strategic Radar</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link px-3 rounded-pill {{ 'active' if active_page == 'command' else '' }}"
                        href="/deal-command">Deal Command</a>
                </li>

                <!-- Divider -->
                <li class="nav-item mx-2 d-none d-lg-block text-secondary opacity-25">|</li>

                <!-- Theme Toggle -->
                <li class="nav-item">
                    <button class="btn btn-sm btn-icon rounded-circle" id="themeToggle" title="Toggle Theme">
                        <i class="bi bi-moon-stars-fill" id="themeIcon"></i>
                    </button>
                </li>
            </ul>
        </div>
    </div>
</header>

<script>
    // Theme Logic
    (function () {
        const toggle = document.getElementById('themeToggle');
        const icon = document.getElementById('themeIcon');
        const html = document.documentElement;

        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'light';
        html.setAttribute('data-theme', savedTheme);
        updateIcon(savedTheme);

        toggle.addEventListener('click', () => {
            const current = html.getAttribute('data-theme');
            const newTheme = current === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateIcon(newTheme);
        });

        function updateIcon(theme) {
            if (theme === 'dark') {
                icon.className = 'bi bi-sun-fill text-warning';
            } else {
                icon.className = 'bi bi-moon-stars-fill text-secondary';
            }
        }
    })();
</script>